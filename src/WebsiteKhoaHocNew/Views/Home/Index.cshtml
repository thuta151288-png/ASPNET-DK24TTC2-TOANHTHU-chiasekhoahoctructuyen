@model IEnumerable<WebsiteKhoaHoc.Models.Course>

@{
    ViewData["Title"] = "Trang chủ";
}

<!-- Hero Section -->
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1>Học Trực Tuyến - Nâng Tầm Tri Thức</h1>
            <p>Khám phá hàng trăm khóa học chất lượng cao từ các chuyên gia hàng đầu. Học mọi lúc, mọi nơi với chi phí hợp lý.</p>
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                <a asp-controller="Courses" asp-action="Index" class="btn btn-primary">
                    <i class="fas fa-book"></i> Khám phá khóa học
                </a>
                @if (!User.Identity!.IsAuthenticated)
                {
                    <a asp-controller="Account" asp-action="Register" class="btn btn-secondary">
                        <i class="fas fa-user-plus"></i> Đăng ký ngay
                    </a>
                }
            </div>
        </div>
    </div>
</section>

<!-- Categories Section -->
<section style="padding: 4rem 0; background: var(--bg-secondary);">
    <div class="container">
        <h2 class="section-title">Danh Mục Khóa Học</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
            @foreach (var category in ViewBag.Categories as List<Category>)
            {
                <a asp-controller="Courses" asp-action="Index" asp-route-categoryId="@category.Id" 
                   class="card" style="text-decoration: none; text-align: center; padding: 2rem;">
                    <i class="fas fa-@GetCategoryIcon(category.Name)" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                    <h4 style="margin-bottom: 0.5rem;">@category.Name</h4>
                    <p style="color: var(--text-muted); font-size: 0.875rem; margin: 0;">@category.Courses.Count khóa học</p>
                </a>
            }
        </div>
    </div>
</section>

<!-- Featured Courses Section -->
<section style="padding: 4rem 0;">
    <div class="container">
        <h2 class="section-title">Khóa Học Nổi Bật</h2>
        <div class="course-grid">
            @foreach (var course in Model)
            {
                <div class="card fade-in">
                    <img src="@(course.CoverImage ?? "/images/default-course.jpg")" alt="@course.Title" class="card-img-top" 
                         onerror="this.src='/images/default-course.jpg'">
                    <div class="card-body">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                            <span class="badge badge-primary">@course.Category.Name</span>
                            <div class="rating">
                                @{
                                    var avgRating = course.Reviews.Any() ? course.Reviews.Average(r => r.Rating) : 0;
                                    for (int i = 1; i <= 5; i++)
                                    {
                                        <i class="fas fa-star" style="color: @(i <= avgRating ? "var(--accent-color)" : "#334155");"></i>
                                    }
                                }
                                <span style="margin-left: 0.5rem; color: var(--text-muted);">(@course.Reviews.Count)</span>
                            </div>
                        </div>
                        <h3 class="card-title">@course.Title</h3>
                        <p class="card-text">@(course.Description.Length > 100 ? course.Description.Substring(0, 100) + "..." : course.Description)</p>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;">
                            <div>
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.875rem;">
                                    <i class="fas fa-user"></i> @course.InstructorName
                                </p>
                            </div>
                            <div style="text-align: right;">
                                <p style="margin: 0; font-size: 1.5rem; font-weight: 700; color: var(--primary-light);">
                                    @course.Price.ToString("N0") đ
                                </p>
                            </div>
                        </div>
                        <a asp-controller="Courses" asp-action="Details" asp-route-id="@course.Id" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                            <i class="fas fa-info-circle"></i> Xem chi tiết
                        </a>
                    </div>
                </div>
            }
        </div>
        <div style="text-align: center; margin-top: 3rem;">
            <a asp-controller="Courses" asp-action="Index" class="btn btn-outline-primary">
                <i class="fas fa-th"></i> Xem tất cả khóa học
            </a>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section style="padding: 4rem 0; background: var(--gradient-dark);">
    <div class="container">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center;">
            <div>
                <h2 style="font-size: 3rem; font-weight: 800; color: var(--primary-light); margin-bottom: 0.5rem;">@Model.Count()+</h2>
                <p style="color: var(--text-secondary); font-size: 1.125rem;">Khóa học chất lượng</p>
            </div>
            <div>
                <h2 style="font-size: 3rem; font-weight: 800; color: var(--primary-light); margin-bottom: 0.5rem;">1000+</h2>
                <p style="color: var(--text-secondary); font-size: 1.125rem;">Học viên đã đăng ký</p>
            </div>
            <div>
                <h2 style="font-size: 3rem; font-weight: 800; color: var(--primary-light); margin-bottom: 0.5rem;">50+</h2>
                <p style="color: var(--text-secondary); font-size: 1.125rem;">Giảng viên chuyên nghiệp</p>
            </div>
            <div>
                <h2 style="font-size: 3rem; font-weight: 800; color: var(--primary-light); margin-bottom: 0.5rem;">4.5★</h2>
                <p style="color: var(--text-secondary); font-size: 1.125rem;">Đánh giá trung bình</p>
            </div>
        </div>
    </div>
</section>

@functions {
    string GetCategoryIcon(string categoryName)
    {
        return categoryName switch
        {
            "Lập trình" => "code",
            "Marketing" => "bullhorn",
            "Thiết kế" => "palette",
            "Kinh doanh" => "briefcase",
            "Ngoại ngữ" => "language",
            _ => "book"
        };
    }
}
